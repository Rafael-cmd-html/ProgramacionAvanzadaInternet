<!DOCTYPE html>
<html>

    <head>

        <title> Principios de canva</title>

        <style>

            #canvas{
                border: 1px solid black 
                
            }
    
        </style>
    </head>
    <body>


        <canvas id="canvas" width="500" height="500"></canvas>
        <img  style="display: none;" src="konkun.png" id="my_image">
        <script>

            var canvas=document.getElementById('canvas');
    
            var contexto= canvas.getContext('2d');
     
            function random_rgba() {

                var o = Math.round, r = Math.random, s = 255;
                return 'rgba(' + o(r()*s) + ',' + o(r()*s) + ',' + o(r()*s) + ',' + r().toFixed(1) + ')';

            }

            //Eventos de teclado

            
            var x=250, y=250, dir=0, w=80, h=85, t_x=100,t_y=200,t_w=40,t_h=40, o_x=110, o_y=50, o_w=270, o_h=30;

            contexto.fillStyle="black"
            contexto.fillRect(t_x,t_y,t_w,t_h);

            contexto.fillStyle="gray"
            contexto.fillRect(o_x,o_y, o_w, o_h);

            paintSquare();
            document.addEventListener("keydown", (e) => {

                /*x=Math.floor(Math.random() * 500);
                y=Math.floor(Math.random() * 500);*/
                

                //Arriba 87
                //Abajo 83
                //Izquierda 65
                //Derecha 68

                switch(e.keyCode){

                    case 87: dir=1;
                    break;
                    case 83: dir=2;
                    break;
                    case 65: dir=3;
                    break;
                    case 68: dir=4;
                    break;

                }
                //update();
                paintSquare();
                contexto.fillStyle="black"
                contexto.fillRect(10,10,40,40);


            });
            
            
            function resetCanvas(){

                    contexto.clearRect(0, 0, canvas.height, canvas.width);

            }
            function paintSquare(){
       
                contexto.fillStyle=random_rgba();
                contexto.fillRect(x,y,w,h)

            }
            
            function update(){

                    if(dir==1){


                        y-=10;
                        if(y<0){

                            y=500;

                        }


                    }else if(dir==2){

                        y+=10;
                        if(y>500){

                            y=0;

                        }

                    }else if(dir==3){

                        x-=10;
                        
                        if(x<0){

                            x=500;

                        }
                    }
                    else if(dir==4){

                        x+=10;
                        if(x>500){

                            x=0;

                        }

                    }

                resetCanvas();
                paintSquare();
                contexto.fillStyle="black"
                contexto.fillRect(t_x,t_y,t_w,t_h);
                
                contexto.fillStyle="gray"
                contexto.fillRect(o_x,o_y, o_w, o_h);


                window.requestAnimationFrame(update);
                if(x < t_x + t_w &&  x + w > t_x &&    y < t_y + t_h &&    y + h > t_y){

                    t_x=Math.floor(Math.random() * canvas.width);
                    t_y=Math.floor(Math.random() * canvas.height);

                }
                
                if(x < o_x + o_w &&  x + w > o_x &&    y < o_y + o_h &&    y + h > o_y){ 
                    if(dir==1){


                        y+=10;
                        if(y<o_y){

                            y=o_h;

                        }


                    }else if(dir==2){

                        y-=10;
                        if(y>o_h){

                            y=o_y;

                        }

                    }else if(dir==3){

                        x+=10;
                        
                        if(x<o_x){

                            x=o_w;

                        }
                    }
                    else if(dir==4){

                        x-=10;
                        if(x>o_w){

                            x=o_x;

                        }

                    }

                }
            }
            window.requestAnimationFrame = (function () {
                return window.requestAnimationFrame ||
                    window.webkitRequestAnimationFrame ||
                    window.mozRequestAnimationFrame ||
                    function (callback) {
                        window.setTimeout(callback, 17);
                    };
            }());
            window.requestAnimationFrame(update);

            //FillStyle permite llenar el rectangulo con el color.
            //FillRect da propiedades al rectangulo ajenas al color (Altura, ancho y coordenadas).
            
            /*
            var figura= true;

            var press= false;

            canvas.addEventListener("click", (e) => {

                if(figura)
                {

                    contexto.beginPath();
                    contexto.arc(e.layerX, e.layerY, 40, 0, 2 * Math.PI);
                    contexto.fill();
                    contexto.closePath();

                }else{

                    contexto.fillRect(e.layerX-50,e.layerY-50,60,65);

                }

            })

            canvas.addEventListener("mouseover",(e)=>{

                color= random_rgba();
                contexto.fillStyle=color;

            })

            canvas.addEventListener("mouseout", (e)=> {

                figura=!figura;

            })

            canvas.addEventListener("mousemove", (e)=>{

                if(press){

                    contexto.beginPath();
                    contexto.arc(e.layerX, e.layerY, 2, 0, 2 * Math.PI);
                    contexto.stroke();
                    contexto.closePath();

                }

            })
            canvas.addEventListener("mousedown", (e)=>{

                press=true;

            })
            canvas.addEventListener("mouseup", (e)=>{

                press=false;

            })
            */

            /*
            contexto.fillStyle="#A22F16";
            contexto.fillRect(10,10,30,15);
    
            contexto.fillStyle="#3F8810";
            contexto.fillRect(30,20,30,15);
    
            contexto.fillStyle="#107088";
            contexto.fillRect(55,30,30,15); 
    
            //Creación de triangulo y linea
    
            contexto.moveTo(50,100);
            contexto.lineTo(125,65);
            contexto.strokeStyle="red";
            contexto.stroke();
    
            //-------
            // Prueba de gitDesktop.
    
            contexto.strokeStyle = "#212121";
            contexto.fillStyle = "green";
    
            contexto.moveTo(200, 50);
            contexto.lineTo(200, 100);
            contexto.lineTo(250, 100);
    
            contexto.closePath();
            contexto.stroke();
            contexto.fill();
    
            //Creación de circulos
    
            contexto.beginPath();
            contexto.arc(70, 130, 15, 0, 2 * Math.PI);
            contexto.stroke();
            contexto.closePath();
            
            contexto.beginPath();
            contexto.arc(120, 130, 15, 0, 2 * Math.PI);
            contexto.fillStyle="blue";
            contexto.fill();
            contexto.closePath();
    
            //Filltext 
            contexto.beginPath();
            contexto.fillStyle="black";
            contexto.font= "10px Arial";
            contexto.fillText("Hola mundo",100,50);
    
            contexto.strokeStyle="red";
            contexto.strokeText("Hola mundo", 103,53);
    
            //Gradiant
            var grd = contexto.createLinearGradient(0, 0, 300, 0);
            grd.addColorStop(0, "black");
            grd.addColorStop(1, "red");
    
            // Draw a filled Rectangle
            contexto.fillStyle = grd;
            contexto.fillRect(180,110,200,110);
            //RadioGradiant
            var grd2 = contexto.createRadialGradient(75, 170, 5, 90, 170, 80);
            grd2.addColorStop(0, "blue");
            grd2.addColorStop(1, "white");
    
    
            contexto.fillStyle = grd2;
            contexto.fillRect(10, 110, 150, 110);
    
            //Imagen
            var img = document.getElementById("my_image");
            contexto.drawImage(img, 10, 250);
            */
        </script>

    </body>
    
</html>